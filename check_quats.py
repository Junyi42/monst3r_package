import torch


quat_a = torch.tensor([[ 0.0274,  0.9966,  0.0465, -0.2835,  0.0750, -0.0355,  0.2321],
        [ 0.0501,  0.9190,  0.0514,  0.2361, -0.0714, -0.0263,  0.2605],
        [ 0.0390,  0.0693,  0.0140,  1.1077,  0.0000,  0.0000,  0.0000],
        [ 0.0140, -0.4481, -0.0761,  0.9135,  0.1033, -0.0157,  0.0589]],
       )

quat_b = torch.tensor([[ 0.0264,  0.9605,  0.0448, -0.2733,  0.0750, -0.0355,  0.2321],
        [ 0.0527,  0.9658,  0.0540,  0.2481, -0.0714, -0.0263,  0.2605],
        [ 0.0351,  0.0624,  0.0126,  0.9974,  0.0000,  0.0000,  0.0000],
        [ 0.0137, -0.4391, -0.0745,  0.8952,  0.1033, -0.0157,  0.0589]],
       )


diff1 = (quat_a[:, :4] * quat_b[:, :4]).sum(dim=-1)
print(diff1)

diff2 = torch.norm(quat_a[:, :4] - quat_b[:, :4], dim=-1)
print(diff2)

# Hongsuk - I think the difference is numerical error in the their roma api. a -> b -> a', then a,a' should be identity...
